/*! For license information please see popup.js.LICENSE.txt */
(()=>{"use strict";function e(){var n,r,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",c=o.toStringTag||"@@toStringTag";function i(e,o,a,c){var i=o&&o.prototype instanceof s?o:s,l=Object.create(i.prototype);return t(l,"_invoke",function(e,t,o){var a,c,i,s=0,l=o||[],f=!1,d={p:0,n:0,v:n,a:p,f:p.bind(n,4),d:function(e,t){return a=e,c=0,i=n,d.n=t,u}};function p(e,t){for(c=e,i=t,r=0;!f&&s&&!o&&r<l.length;r++){var o,a=l[r],p=d.p,v=a[2];e>3?(o=v===t)&&(i=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=n):a[0]<=p&&((o=e<2&&p<a[1])?(c=0,d.v=t,d.n=a[1]):p<v&&(o=e<3||a[0]>t||t>v)&&(a[4]=e,a[5]=t,d.n=v,c=0))}if(o||e>1)return u;throw f=!0,t}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&p(l,v),c=l,i=v;(r=c<2?n:i)||!f;){a||(c?c<3?(c>1&&(d.n=-1),p(c,i)):d.n=i:d.v=i);try{if(s=2,a){if(c||(o="next"),r=a[o]){if(!(r=r.call(a,i)))throw TypeError("iterator result is not an object");if(!r.done)return r;i=r.value,c<2&&(c=0)}else 1===c&&(r=a.return)&&r.call(a),c<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=n}else if((r=(f=d.n<0)?i:e.call(t,d))!==u)break}catch(e){a=n,c=1,i=e}finally{s=1}}return{value:r,done:f}}}(e,a,c),!0),l}var u={};function s(){}function l(){}function f(){}r=Object.getPrototypeOf;var d=[][a]?r(r([][a]())):(t(r={},a,function(){return this}),r),p=f.prototype=s.prototype=Object.create(d);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,t(e,c,"GeneratorFunction")),e.prototype=Object.create(p),e}return l.prototype=f,t(p,"constructor",f),t(f,"constructor",l),l.displayName="GeneratorFunction",t(f,c,"GeneratorFunction"),t(p),t(p,c,"Generator"),t(p,a,function(){return this}),t(p,"toString",function(){return"[object Generator]"}),(e=function(){return{w:i,m:v}})()}function t(e,n,r,o){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}t=function(e,n,r,o){function c(n,r){t(e,n,function(e){return this._invoke(n,r,e)})}n?a?a(e,n,{value:r,enumerable:!o,configurable:!o,writable:!o}):e[n]=r:(c("next",0),c("throw",1),c("return",2))},t(e,n,r,o)}function n(e,t,n,r,o,a,c){try{var i=e[a](c),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,o)}function r(e){return function(){var t=this,r=arguments;return new Promise(function(o,a){var c=e.apply(t,r);function i(e){n(c,o,a,i,u,"next",e)}function u(e){n(c,o,a,i,u,"throw",e)}i(void 0)})}}function o(e,t){return a.apply(this,arguments)}function a(){return a=r(e().m(function t(n,r){var o,a,c,i=arguments;return e().w(function(e){for(;;)switch(e.n){case 0:return o=i.length>2&&void 0!==i[2]?i[2]:1e5,a=new TextEncoder,e.n=1,window.crypto.subtle.importKey("raw",a.encode(n),{name:"PBKDF2"},!1,["deriveKey"]);case 1:return c=e.v,e.a(2,window.crypto.subtle.deriveKey({name:"PBKDF2",salt:r,iterations:o,hash:"SHA-256"},c,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"]))}},t)})),a.apply(this,arguments)}function c(e,t){return i.apply(this,arguments)}function i(){return(i=r(e().m(function t(n,r){var o,a,c;return e().w(function(e){for(;;)switch(e.n){case 0:return o=new TextEncoder,a=window.crypto.getRandomValues(new Uint8Array(12)),e.n=1,window.crypto.subtle.encrypt({name:"AES-GCM",iv:a},n,o.encode(r));case 1:return c=e.v,e.a(2,{iv:Array.from(a),ciphertext:Array.from(new Uint8Array(c))})}},t)}))).apply(this,arguments)}function u(e,t,n){return s.apply(this,arguments)}function s(){return(s=r(e().m(function t(n,r,o){var a,c,i,u;return e().w(function(e){for(;;)switch(e.n){case 0:return a=new TextDecoder,c=new Uint8Array(o),i=new Uint8Array(r),e.n=1,window.crypto.subtle.decrypt({name:"AES-GCM",iv:i},n,c);case 1:return u=e.v,e.a(2,a.decode(u))}},t)}))).apply(this,arguments)}function l(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof i?r:i,s=Object.create(u.prototype);return f(s,"_invoke",function(n,r,o){var a,i,u,s=0,l=o||[],f=!1,d={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return a=t,i=0,u=e,d.n=n,c}};function p(n,r){for(i=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,a=l[t],p=d.p,v=a[2];n>3?(o=v===r)&&(u=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=p&&((o=n<2&&p<a[1])?(i=0,d.v=r,d.n=a[1]):p<v&&(o=n<3||a[0]>r||r>v)&&(a[4]=n,a[5]=r,d.n=v,i=0))}if(o||n>1)return c;throw f=!0,r}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&p(l,v),i=l,u=v;(t=i<2?e:u)||!f;){a||(i?i<3?(i>1&&(d.n=-1),p(i,u)):d.n=u:d.v=u);try{if(s=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(f=d.n<0)?u:n.call(r,d))!==c)break}catch(t){a=e,i=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,a),!0),s}var c={};function i(){}function u(){}function s(){}t=Object.getPrototypeOf;var d=[][r]?t(t([][r]())):(f(t={},r,function(){return this}),t),p=s.prototype=i.prototype=Object.create(d);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,f(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return u.prototype=s,f(p,"constructor",s),f(s,"constructor",u),u.displayName="GeneratorFunction",f(s,o,"GeneratorFunction"),f(p),f(p,o,"Generator"),f(p,r,function(){return this}),f(p,"toString",function(){return"[object Generator]"}),(l=function(){return{w:a,m:v}})()}function f(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}f=function(e,t,n,r){function a(t,n){f(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},f(e,t,n,r)}function d(e,t,n,r,o,a,c){try{var i=e[a](c),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,o)}function p(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function c(e){d(a,r,o,c,i,"next",e)}function i(e){d(a,r,o,c,i,"throw",e)}c(void 0)})}}var v="vault",m="settings";function y(){return h.apply(this,arguments)}function h(){return(h=p(l().m(function e(){return l().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,t){var n=indexedDB.open("secure-shelf-db",1);n.onerror=function(e){t("Error opening database: "+e.target.error)},n.onsuccess=function(t){e(t.target.result)},n.onupgradeneeded=function(e){var t=e.target.result;t.objectStoreNames.contains(v)||t.createObjectStore(v,{keyPath:"id"}),t.objectStoreNames.contains(m)||t.createObjectStore(m,{keyPath:"id"})}}))},e)}))).apply(this,arguments)}function b(e){return w.apply(this,arguments)}function w(){return(w=p(l().m(function e(t){var n;return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,y();case 1:return n=e.v,e.a(2,new Promise(function(e,r){var o=n.transaction([v],"readwrite"),a=o.objectStore(v).put(t);a.onsuccess=function(){e()},a.onerror=function(e){r("Error saving to vault: "+e.target.error)},o.oncomplete=function(){n.close()}}))}},e)}))).apply(this,arguments)}function g(e){return E.apply(this,arguments)}function E(){return(E=p(l().m(function e(t){var n;return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,y();case 1:return n=e.v,e.a(2,new Promise(function(e,r){var o=n.transaction([v],"readonly"),a=o.objectStore(v).get(t);a.onsuccess=function(t){e(t.target.result)},a.onerror=function(e){r("Error retrieving from vault: "+e.target.error)},o.oncomplete=function(){n.close()}}))}},e)}))).apply(this,arguments)}function k(){return O.apply(this,arguments)}function O(){return(O=p(l().m(function e(){var t;return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,y();case 1:return t=e.v,e.a(2,new Promise(function(e,n){var r=t.transaction([v],"readonly"),o=r.objectStore(v).getAll();o.onsuccess=function(t){e(t.target.result)},o.onerror=function(e){n("Error retrieving all from vault: "+e.target.error)},r.oncomplete=function(){t.close()}}))}},e)}))).apply(this,arguments)}function S(e){return j.apply(this,arguments)}function j(){return(j=p(l().m(function e(t){var n;return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,y();case 1:return n=e.v,e.a(2,new Promise(function(e,r){var o=n.transaction([v],"readwrite"),a=o.objectStore(v).delete(t);a.onsuccess=function(){e()},a.onerror=function(e){r("Error removing from vault: "+e.target.error)},o.oncomplete=function(){n.close()}}))}},e)}))).apply(this,arguments)}function I(e){return x.apply(this,arguments)}function x(){return(x=p(l().m(function e(t){var n;return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,y();case 1:return n=e.v,e.a(2,new Promise(function(e,r){var o=n.transaction([m],"readwrite"),a=o.objectStore(m).put(t);a.onsuccess=function(){e()},a.onerror=function(e){r("Error saving settings: "+e.target.error)},o.oncomplete=function(){n.close()}}))}},e)}))).apply(this,arguments)}function P(e){return B.apply(this,arguments)}function B(){return(B=p(l().m(function e(t){var n;return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,y();case 1:return n=e.v,e.a(2,new Promise(function(e,r){var o=n.transaction([m],"readonly"),a=o.objectStore(m).get(t);a.onsuccess=function(t){e(t.target.result)},a.onerror=function(e){r("Error retrieving settings: "+e.target.error)},o.oncomplete=function(){n.close()}}))}},e)}))).apply(this,arguments)}function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function L(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return A(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){i=!0,a=e},f:function(){try{c||null==n.return||n.return()}finally{if(i)throw a}}}}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach(function(t){_(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function _(e,t,n){return(t=function(e){var t=function(e){if("object"!=C(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=C(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==C(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function D(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof i?r:i,s=Object.create(u.prototype);return F(s,"_invoke",function(n,r,o){var a,i,u,s=0,l=o||[],f=!1,d={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return a=t,i=0,u=e,d.n=n,c}};function p(n,r){for(i=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,a=l[t],p=d.p,v=a[2];n>3?(o=v===r)&&(u=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=p&&((o=n<2&&p<a[1])?(i=0,d.v=r,d.n=a[1]):p<v&&(o=n<3||a[0]>r||r>v)&&(a[4]=n,a[5]=r,d.n=v,i=0))}if(o||n>1)return c;throw f=!0,r}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&p(l,v),i=l,u=v;(t=i<2?e:u)||!f;){a||(i?i<3?(i>1&&(d.n=-1),p(i,u)):d.n=u:d.v=u);try{if(s=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(f=d.n<0)?u:n.call(r,d))!==c)break}catch(t){a=e,i=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,a),!0),s}var c={};function i(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(F(t={},r,function(){return this}),t),f=s.prototype=i.prototype=Object.create(l);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,F(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,F(f,"constructor",s),F(s,"constructor",u),u.displayName="GeneratorFunction",F(s,o,"GeneratorFunction"),F(f),F(f,o,"Generator"),F(f,r,function(){return this}),F(f,"toString",function(){return"[object Generator]"}),(D=function(){return{w:a,m:d}})()}function F(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}F=function(e,t,n,r){function a(t,n){F(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},F(e,t,n,r)}function N(e,t,n,r,o,a,c){try{var i=e[a](c),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,o)}function M(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function c(e){N(a,r,o,c,i,"next",e)}function i(e){N(a,r,o,c,i,"throw",e)}c(void 0)})}}var V="vault-metadata",U="vault-salt",R=null,J=!0;function q(e){return z.apply(this,arguments)}function z(){return(z=M(D().m(function e(t){var n,r,a,i;return D().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,n=window.crypto.getRandomValues(new Uint8Array(16)),e.n=1,I({id:U,salt:Array.from(n)});case 1:return r={id:V,created:(new Date).toISOString(),lastModified:(new Date).toISOString(),version:1},e.n=2,o(t,n);case 2:return R=e.v,e.n=3,c(R,JSON.stringify(r));case 3:return a=e.v,e.n=4,b({id:V,data:a});case 4:return J=!1,e.a(2,!0);case 5:return e.p=5,i=e.v,console.error("Error initializing vault:",i),e.a(2,!1)}},e,null,[[0,5]])}))).apply(this,arguments)}function K(){return $.apply(this,arguments)}function $(){return($=M(D().m(function e(){var t;return D().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,g(V);case 1:return t=e.v,e.a(2,!!t);case 2:return e.p=2,e.v,e.a(2,!1)}},e,null,[[0,2]])}))).apply(this,arguments)}function H(e){return Z.apply(this,arguments)}function Z(){return Z=M(D().m(function e(t){var n,r,a,i,s,l,f,d,p=arguments;return D().w(function(e){for(;;)switch(e.p=e.n){case 0:return n=p.length>1&&void 0!==p[1]?p[1]:5,e.p=1,e.n=2,P(U);case 2:if(r=e.v){e.n=3;break}return e.a(2,!1);case 3:return a=new Uint8Array(r.salt),e.n=4,o(t,a);case 4:return R=e.v,e.n=5,g(V);case 5:if(i=e.v){e.n=6;break}return e.a(2,!1);case 6:return e.p=6,e.n=7,u(R,i.data.iv,i.data.ciphertext);case 7:return s=e.v,JSON.parse(s),(l=JSON.parse(s)).lastAccessed=(new Date).toISOString(),e.n=8,c(R,JSON.stringify(l));case 8:return f=e.v,e.n=9,b({id:V,data:f});case 9:return J=!1,chrome.runtime.sendMessage({action:"unlockVault",lockAfterMinutes:n}),e.a(2,!0);case 10:return e.p=10,e.v,e.a(2,!1);case 11:return e.p=11,d=e.v,console.error("Error unlocking vault:",d),e.a(2,!1);case 12:return e.a(2)}},e,null,[[6,10],[1,11]])})),Z.apply(this,arguments)}function W(){R=null,J=!0,chrome.runtime.sendMessage({action:"lockVault"})}function Q(e){return X.apply(this,arguments)}function X(){return(X=M(D().m(function e(t){var n,r;return D().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!J&&R){e.n=1;break}throw new Error("Vault is locked");case 1:return e.p=1,t.id||(t.id="cred-"+Date.now()+"-"+Math.floor(1e3*Math.random())),t.createdAt=(new Date).toISOString(),t.updatedAt=(new Date).toISOString(),e.n=2,c(R,JSON.stringify(t));case 2:return n=e.v,e.n=3,b({id:t.id,url:t.url,username:t.username,data:n});case 3:return e.a(2,t.id);case 4:throw e.p=4,r=e.v,console.error("Error adding credential:",r),r;case 5:return e.a(2)}},e,null,[[1,4]])}))).apply(this,arguments)}function Y(e,t){return ee.apply(this,arguments)}function ee(){return(ee=M(D().m(function e(t,n){var r,o,a,i,s,l;return D().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!J&&R){e.n=1;break}throw new Error("Vault is locked");case 1:return e.p=1,e.n=2,g(t);case 2:if(r=e.v){e.n=3;break}return e.a(2,!1);case 3:return e.n=4,u(R,r.data.iv,r.data.ciphertext);case 4:return o=e.v,a=JSON.parse(o),i=G(G(G({},a),n),{},{updatedAt:(new Date).toISOString()}),e.n=5,c(R,JSON.stringify(i));case 5:return s=e.v,e.n=6,b({id:t,url:i.url,username:i.username,data:s});case 6:return e.a(2,!0);case 7:throw e.p=7,l=e.v,console.error("Error updating credential:",l),l;case 8:return e.a(2)}},e,null,[[1,7]])}))).apply(this,arguments)}function te(e){return ne.apply(this,arguments)}function ne(){return(ne=M(D().m(function e(t){var n,r,o;return D().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!J&&R){e.n=1;break}throw new Error("Vault is locked");case 1:return e.p=1,e.n=2,g(t);case 2:if(n=e.v){e.n=3;break}return e.a(2,null);case 3:return e.n=4,u(R,n.data.iv,n.data.ciphertext);case 4:return r=e.v,e.a(2,JSON.parse(r));case 5:throw e.p=5,o=e.v,console.error("Error getting credential:",o),o;case 6:return e.a(2)}},e,null,[[1,5]])}))).apply(this,arguments)}function re(){return oe.apply(this,arguments)}function oe(){return(oe=M(D().m(function e(){var t,n,r,o,a,c,i,s,l;return D().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!J&&R){e.n=1;break}throw new Error("Vault is locked");case 1:return e.p=1,e.n=2,k();case 2:t=e.v,n=[],r=L(t),e.p=3,r.s();case 4:if((o=r.n()).done){e.n=9;break}if((a=o.value).id!==V){e.n=5;break}return e.a(3,8);case 5:return e.p=5,e.n=6,u(R,a.data.iv,a.data.ciphertext);case 6:c=e.v,n.push(JSON.parse(c)),e.n=8;break;case 7:e.p=7,i=e.v,console.error("Error decrypting credential ".concat(a.id,":"),i);case 8:e.n=4;break;case 9:e.n=11;break;case 10:e.p=10,s=e.v,r.e(s);case 11:return e.p=11,r.f(),e.f(11);case 12:return e.a(2,n);case 13:throw e.p=13,l=e.v,console.error("Error getting all credentials:",l),l;case 14:return e.a(2)}},e,null,[[5,7],[3,10,11,12],[1,13]])}))).apply(this,arguments)}function ae(e){return ce.apply(this,arguments)}function ce(){return(ce=M(D().m(function e(t){var n;return D().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!J&&R){e.n=1;break}throw new Error("Vault is locked");case 1:return e.p=1,e.n=2,S(t);case 2:return e.a(2,!0);case 3:return e.p=3,n=e.v,console.error("Error deleting credential:",n),e.a(2,!1)}},e,null,[[1,3]])}))).apply(this,arguments)}function ie(e){return ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ie(e)}function ue(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return se(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?se(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){i=!0,a=e},f:function(){try{c||null==n.return||n.return()}finally{if(i)throw a}}}}function se(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(Object(n),!0).forEach(function(t){de(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function de(e,t,n){return(t=function(e){var t=function(e){if("object"!=ie(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ie(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ie(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pe(e,t,n,r){var o=new Uint32Array(2*e);window.crypto.getRandomValues(o);for(var a="",c="",i=new Set,u=0,s=0;s<e;s++){var l=void 0,f=0;do{var d=o[u++];if(u>=o.length&&(window.crypto.getRandomValues(o),u=0),l=t[d%t.length],f++,!(n&&l===c||r&&i.has(l))&&f>=10)break}while(n&&l===c||r&&i.has(l));a+=l,c=l,i.add(l)}return a}function ve(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function me(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof i?r:i,s=Object.create(u.prototype);return ye(s,"_invoke",function(n,r,o){var a,i,u,s=0,l=o||[],f=!1,d={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return a=t,i=0,u=e,d.n=n,c}};function p(n,r){for(i=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,a=l[t],p=d.p,v=a[2];n>3?(o=v===r)&&(u=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=p&&((o=n<2&&p<a[1])?(i=0,d.v=r,d.n=a[1]):p<v&&(o=n<3||a[0]>r||r>v)&&(a[4]=n,a[5]=r,d.n=v,i=0))}if(o||n>1)return c;throw f=!0,r}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&p(l,v),i=l,u=v;(t=i<2?e:u)||!f;){a||(i?i<3?(i>1&&(d.n=-1),p(i,u)):d.n=u:d.v=u);try{if(s=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(f=d.n<0)?u:n.call(r,d))!==c)break}catch(t){a=e,i=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,a),!0),s}var c={};function i(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(ye(t={},r,function(){return this}),t),f=s.prototype=i.prototype=Object.create(l);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,ye(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,ye(f,"constructor",s),ye(s,"constructor",u),u.displayName="GeneratorFunction",ye(s,o,"GeneratorFunction"),ye(f),ye(f,o,"Generator"),ye(f,r,function(){return this}),ye(f,"toString",function(){return"[object Generator]"}),(me=function(){return{w:a,m:d}})()}function ye(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}ye=function(e,t,n,r){function a(t,n){ye(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},ye(e,t,n,r)}function he(e,t,n,r,o,a,c){try{var i=e[a](c),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,o)}function be(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function c(e){he(a,r,o,c,i,"next",e)}function i(e){he(a,r,o,c,i,"throw",e)}c(void 0)})}}var we={auth:document.getElementById("auth-screen"),dashboard:document.getElementById("dashboard-screen"),detail:document.getElementById("detail-screen"),form:document.getElementById("credential-form-screen"),passwordGenerator:document.getElementById("generate-password-screen")},ge=document.getElementById("login-tab"),Ee=document.getElementById("setup-tab"),ke=document.getElementById("login-form"),Oe=document.getElementById("setup-form"),Se=document.getElementById("master-password"),je=document.getElementById("new-master-password"),Ie=document.getElementById("confirm-master-password"),xe=document.getElementById("unlock-button"),Pe=document.getElementById("setup-button"),Be=document.getElementById("login-error"),Ce=document.getElementById("setup-error"),Le=document.getElementById("credentials-list"),Ae=document.getElementById("search-input"),Te=document.getElementById("add-credential-button"),Ge=document.getElementById("options-button"),_e=document.getElementById("lock-button"),De=document.getElementById("empty-state"),Fe=document.getElementById("back-to-list-button"),Ne=document.getElementById("detail-url"),Me=document.getElementById("username-value"),Ve=document.getElementById("password-value"),Ue=document.getElementById("detail-notes"),Re=document.getElementById("copy-username"),Je=document.getElementById("copy-password"),qe=document.getElementById("show-password"),ze=document.getElementById("edit-credential-button"),Ke=document.getElementById("delete-credential-button"),$e=document.getElementById("form-title"),He=document.getElementById("cancel-form-button"),Ze=document.getElementById("credential-url"),We=document.getElementById("credential-name"),Qe=document.getElementById("credential-username"),Xe=document.getElementById("credential-password"),Ye=document.getElementById("credential-notes"),et=document.getElementById("generate-password"),tt=document.getElementById("toggle-password"),nt=document.getElementById("save-credential-button"),rt=document.getElementById("form-error"),ot=document.getElementById("close-generator-button"),at=document.getElementById("password-length"),ct=document.getElementById("length-value"),it=document.getElementById("include-uppercase"),ut=document.getElementById("include-lowercase"),st=document.getElementById("include-numbers"),lt=document.getElementById("include-symbols"),ft=document.getElementById("generated-password"),dt=document.getElementById("copy-generated"),pt=document.getElementById("regenerate-button"),vt=document.getElementById("use-password-button"),mt=[],yt=null,ht=!1;function bt(){return wt.apply(this,arguments)}function wt(){return(wt=be(me().m(function e(){var t;return me().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,jt(we.dashboard),e.n=1,gt();case 1:e.n=3;break;case 2:e.p=2,t=e.v,console.error("Dashboard loading error:",t);case 3:return e.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}function gt(){return Et.apply(this,arguments)}function Et(){return(Et=be(me().m(function e(){var t;return me().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,re();case 1:for(mt=e.v;Le.firstChild;)Le.removeChild(Le.firstChild);if(0!==mt.length){e.n=2;break}return Le.appendChild(De),e.a(2);case 2:De.remove(),mt.forEach(function(e){var t=document.createElement("div");t.className="credential-item",t.dataset.id=e.id;var n=document.createElement("div");n.className="title",n.textContent=e.name||e.url;var r=document.createElement("div");r.className="username",r.textContent=e.username||"",t.appendChild(n),t.appendChild(r),t.addEventListener("click",function(){kt(e.id)}),Le.appendChild(t)}),e.n=4;break;case 3:e.p=3,t=e.v,console.error("Credentials loading error:",t);case 4:return e.a(2)}},e,null,[[0,3]])}))).apply(this,arguments)}function kt(e){return Ot.apply(this,arguments)}function Ot(){return(Ot=be(me().m(function e(t){var n,r;return me().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,yt=t,e.n=1,te(t);case 1:if(n=e.v){e.n=2;break}return e.a(2);case 2:Ne.textContent=n.url||"",Me.textContent=n.username||"",Ve.textContent="••••••••",Ve.dataset.password=n.password||"",Ue.textContent=n.notes||"",jt(we.detail),e.n=4;break;case 3:e.p=3,r=e.v,console.error("Detail view error:",r);case 4:return e.a(2)}},e,null,[[0,3]])}))).apply(this,arguments)}function St(){var e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=fe(fe({},{length:16,uppercase:!0,lowercase:!0,numbers:!0,symbols:!0,excludeAmbiguous:!1,excludeSimilar:!1,required:"",excluded:"",noConsecutive:!1,noRepeats:!1}),e);t.uppercase||t.lowercase||t.numbers||t.symbols||(t.lowercase=!0);var n="";if(t.uppercase&&(n+="ABCDEFGHIJKLMNOPQRSTUVWXYZ"),t.lowercase&&(n+="abcdefghijklmnopqrstuvwxyz"),t.numbers&&(n+="0123456789"),t.symbols&&(n+="!@#$%^&*()-_=+[]{}|;:,.<>?/"),t.excluded){var r,o=ue(t.excluded);try{for(o.s();!(r=o.n()).done;){var a=r.value;n=n.replace(new RegExp(ve(a),"g"),"")}}catch(e){o.e(e)}finally{o.f()}}if(t.excludeAmbiguous){var c,i=ue("1lI0O{}[]()/'\"`~,;:.<>");try{for(i.s();!(c=i.n()).done;){var u=c.value;n=n.replace(new RegExp(ve(u),"g"),"")}}catch(e){i.e(e)}finally{i.f()}}if(t.excludeSimilar){var s,l=ue("il1Lo0O");try{for(l.s();!(s=l.n()).done;){var f=s.value;n=n.replace(new RegExp(ve(f),"g"),"")}}catch(e){l.e(e)}finally{l.f()}}if(!n)throw new Error("No characters available after applying exclusions");for(var d="",p=0;p<100;){if(p++,d=pe(t.length,n,t.noConsecutive,t.noRepeats),t.required){var v,m=!0,y=ue(t.required);try{for(y.s();!(v=y.n()).done;){var h=v.value;if(!d.includes(h)){m=!1;break}}}catch(e){y.e(e)}finally{y.f()}if(!m)continue}var b=!0;if(t.uppercase&&!/[A-Z]/.test(d)&&(b=!1),t.lowercase&&!/[a-z]/.test(d)&&(b=!1),t.numbers&&!/[0-9]/.test(d)&&(b=!1),t.symbols&&!/[^A-Za-z0-9]/.test(d)&&(b=!1),b)break}return p>=100?function(e){var t="";e.uppercase&&(t+="ABCDEFGHJKLMNPQRSTUVWXYZ"),e.lowercase&&(t+="abcdefghijkmnopqrstuvwxyz"),e.numbers&&(t+="23456789"),e.symbols&&(t+="!@#$%^&*()-_=+"),t||(t="abcdefghijkmnopqrstuvwxyz23456789");var n=new Uint32Array(e.length);window.crypto.getRandomValues(n);for(var r="",o=0;o<e.length;o++)r+=t[n[o]%t.length];return r}(t):d}({length:parseInt(at.value),uppercase:it.checked,lowercase:ut.checked,numbers:st.checked,symbols:lt.checked});ft.value=e}function jt(e){Object.values(we).forEach(function(e){e.classList.remove("active")}),e.classList.add("active")}function It(e,t){e.textContent=t,e.classList.remove("hidden")}function xt(e){navigator.clipboard.writeText(e).catch(function(e){console.error("Could not copy text: ",e)})}function Pt(e){chrome.tabs?chrome.tabs.query({active:!0,currentWindow:!0},function(t){e(t[0])}):e(null)}document.addEventListener("DOMContentLoaded",be(me().m(function e(){var t;return me().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,chrome.runtime.onMessage.addListener(function(e,t,n){return"autoLockVault"===e.action&&(W(),jt("auth"),displayMessage(Be,"Vault has been automatically locked for security.")),!0}),e.n=1,K();case 1:e.v?(ge.classList.add("active"),Ee.classList.remove("active"),ke.classList.remove("hidden"),Oe.classList.add("hidden")):(ge.classList.remove("active"),Ee.classList.add("active"),ke.classList.add("hidden"),Oe.classList.remove("hidden")),Pt(function(){var e=be(me().m(function e(t){return me().w(function(e){for(;;)switch(e.n){case 0:t&&t.url&&(Ze.value=t.url);case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),e.n=3;break;case 2:e.p=2,t=e.v,console.error("Initialization error:",t),It(Be,"Failed to initialize the application.");case 3:return e.a(2)}},e,null,[[0,2]])}))),ge.addEventListener("click",function(){ge.classList.add("active"),Ee.classList.remove("active"),ke.classList.remove("hidden"),Oe.classList.add("hidden")}),Ee.addEventListener("click",function(){ge.classList.remove("active"),Ee.classList.add("active"),ke.classList.add("hidden"),Oe.classList.remove("hidden")}),xe.addEventListener("click",be(me().m(function e(){var t,n;return me().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=Se.value){e.n=1;break}return It(Be,"Please enter your master password."),e.a(2);case 1:return e.p=1,e.n=2,H(t);case 2:if(!e.v){e.n=4;break}return Se.value="",Be.classList.add("hidden"),e.n=3,bt();case 3:e.n=5;break;case 4:It(Be,"Incorrect master password.");case 5:e.n=7;break;case 6:e.p=6,n=e.v,console.error("Unlock error:",n),It(Be,"Failed to unlock the vault.");case 7:return e.a(2)}},e,null,[[1,6]])}))),Pe.addEventListener("click",be(me().m(function e(){var t,n,r;return me().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=je.value,n=Ie.value,t){e.n=1;break}return It(Ce,"Please enter a master password."),e.a(2);case 1:if(!(t.length<8)){e.n=2;break}return It(Ce,"Master password must be at least 8 characters."),e.a(2);case 2:if(t===n){e.n=3;break}return It(Ce,"Passwords do not match."),e.a(2);case 3:return e.p=3,e.n=4,q(t);case 4:if(!e.v){e.n=6;break}return je.value="",Ie.value="",Ce.classList.add("hidden"),e.n=5,bt();case 5:e.n=7;break;case 6:It(Ce,"Failed to create the vault.");case 7:e.n=9;break;case 8:e.p=8,r=e.v,console.error("Setup error:",r),It(Ce,"Failed to create the vault.");case 9:return e.a(2)}},e,null,[[3,8]])}))),Ae.addEventListener("input",function(){var e=Ae.value.toLowerCase();Le.querySelectorAll(".credential-item").forEach(function(t){var n=t.querySelector(".title").textContent.toLowerCase(),r=t.querySelector(".username").textContent.toLowerCase();n.includes(e)||r.includes(e)?t.style.display="block":t.style.display="none"})}),qe.addEventListener("click",function(){"••••••••"===Ve.textContent?(Ve.textContent=Ve.dataset.password,qe.textContent="Hide"):(Ve.textContent="••••••••",qe.textContent="Show")}),Re.addEventListener("click",function(){xt(Me.textContent),Re.textContent="Copied!",setTimeout(function(){Re.textContent="Copy"},1500)}),Je.addEventListener("click",function(){xt(Ve.dataset.password),Je.textContent="Copied!",setTimeout(function(){Je.textContent="Copy"},1500)}),ze.addEventListener("click",function(){var e;ht=!0,$e.textContent="Edit Credential",Ze.value=Ne.textContent,We.value=(null===(e=mt.find(function(e){return e.id===yt}))||void 0===e?void 0:e.name)||"",Qe.value=Me.textContent,Xe.value=Ve.dataset.password,Ye.value=Ue.textContent,jt(we.form)}),Ke.addEventListener("click",be(me().m(function e(){var t;return me().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!confirm("Are you sure you want to delete this credential?")){e.n=5;break}return e.p=1,e.n=2,ae(yt);case 2:return Fe.click(),e.n=3,gt();case 3:e.n=5;break;case 4:e.p=4,t=e.v,console.error("Delete error:",t);case 5:return e.a(2)}},e,null,[[1,4]])}))),Fe.addEventListener("click",function(){jt(we.dashboard)}),Te.addEventListener("click",function(){ht=!1,$e.textContent="Add Credential",Ze.value="",We.value="",Qe.value="",Xe.value="",Ye.value="",Pt(function(e){e&&e.url&&(Ze.value=e.url)}),jt(we.form)}),He.addEventListener("click",function(){jt(ht?we.detail:we.dashboard)}),nt.addEventListener("click",be(me().m(function e(){var t,n,r,o,a,c,i;return me().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,t=Ze.value,n=We.value,r=Qe.value,o=Xe.value,a=Ye.value,t){e.n=1;break}return It(rt,"Please enter a URL."),e.a(2);case 1:if(o){e.n=2;break}return It(rt,"Please enter a password."),e.a(2);case 2:if(c={url:t,name:n,username:r,password:o,notes:a},!ht){e.n=4;break}return e.n=3,Y(yt,c);case 3:e.n=5;break;case 4:return e.n=5,Q(c);case 5:return jt(we.dashboard),e.n=6,gt();case 6:e.n=8;break;case 7:e.p=7,i=e.v,console.error("Save error:",i),It(rt,"Failed to save credential.");case 8:return e.a(2)}},e,null,[[0,7]])}))),et.addEventListener("click",function(){jt(we.passwordGenerator),St()}),tt.addEventListener("click",function(){"password"===Xe.type?(Xe.type="text",tt.textContent="🔒"):(Xe.type="password",tt.textContent="👁️")}),_e.addEventListener("click",function(){W(),jt(we.auth)}),Ge.addEventListener("click",function(){chrome.runtime.openOptionsPage()}),at.addEventListener("input",function(){ct.textContent=at.value}),pt.addEventListener("click",function(){St()}),vt.addEventListener("click",function(){Xe.value=ft.value,jt(we.form)}),ot.addEventListener("click",function(){jt(we.form)}),dt.addEventListener("click",function(){xt(ft.value),dt.textContent="✓",setTimeout(function(){dt.textContent="📋"},1500)})})();