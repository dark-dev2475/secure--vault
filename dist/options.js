/*! For license information please see options.js.LICENSE.txt */
(()=>{"use strict";function e(){var n,r,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",c=o.toStringTag||"@@toStringTag";function i(e,o,a,c){var i=o&&o.prototype instanceof s?o:s,l=Object.create(i.prototype);return t(l,"_invoke",function(e,t,o){var a,c,i,s=0,l=o||[],f=!1,p={p:0,n:0,v:n,a:d,f:d.bind(n,4),d:function(e,t){return a=e,c=0,i=n,p.n=t,u}};function d(e,t){for(c=e,i=t,r=0;!f&&s&&!o&&r<l.length;r++){var o,a=l[r],d=p.p,v=a[2];e>3?(o=v===t)&&(i=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=n):a[0]<=d&&((o=e<2&&d<a[1])?(c=0,p.v=t,p.n=a[1]):d<v&&(o=e<3||a[0]>t||t>v)&&(a[4]=e,a[5]=t,p.n=v,c=0))}if(o||e>1)return u;throw f=!0,t}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,v),c=l,i=v;(r=c<2?n:i)||!f;){a||(c?c<3?(c>1&&(p.n=-1),d(c,i)):p.n=i:p.v=i);try{if(s=2,a){if(c||(o="next"),r=a[o]){if(!(r=r.call(a,i)))throw TypeError("iterator result is not an object");if(!r.done)return r;i=r.value,c<2&&(c=0)}else 1===c&&(r=a.return)&&r.call(a),c<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=n}else if((r=(f=p.n<0)?i:e.call(t,p))!==u)break}catch(e){a=n,c=1,i=e}finally{s=1}}return{value:r,done:f}}}(e,a,c),!0),l}var u={};function s(){}function l(){}function f(){}r=Object.getPrototypeOf;var p=[][a]?r(r([][a]())):(t(r={},a,function(){return this}),r),d=f.prototype=s.prototype=Object.create(p);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,t(e,c,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=f,t(d,"constructor",f),t(f,"constructor",l),l.displayName="GeneratorFunction",t(f,c,"GeneratorFunction"),t(d),t(d,c,"Generator"),t(d,a,function(){return this}),t(d,"toString",function(){return"[object Generator]"}),(e=function(){return{w:i,m:v}})()}function t(e,n,r,o){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}t=function(e,n,r,o){function c(n,r){t(e,n,function(e){return this._invoke(n,r,e)})}n?a?a(e,n,{value:r,enumerable:!o,configurable:!o,writable:!o}):e[n]=r:(c("next",0),c("throw",1),c("return",2))},t(e,n,r,o)}function n(e,t,n,r,o,a,c){try{var i=e[a](c),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,o)}function r(e){return function(){var t=this,r=arguments;return new Promise(function(o,a){var c=e.apply(t,r);function i(e){n(c,o,a,i,u,"next",e)}function u(e){n(c,o,a,i,u,"throw",e)}i(void 0)})}}var o="vault",a="settings";function c(){return i.apply(this,arguments)}function i(){return(i=r(e().m(function t(){return e().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,t){var n=indexedDB.open("secure-shelf-db",1);n.onerror=function(e){t("Error opening database: "+e.target.error)},n.onsuccess=function(t){e(t.target.result)},n.onupgradeneeded=function(e){var t=e.target.result;t.objectStoreNames.contains(o)||t.createObjectStore(o,{keyPath:"id"}),t.objectStoreNames.contains(a)||t.createObjectStore(a,{keyPath:"id"})}}))},t)}))).apply(this,arguments)}function u(e){return s.apply(this,arguments)}function s(){return(s=r(e().m(function t(n){var r;return e().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,c();case 1:return r=e.v,e.a(2,new Promise(function(e,t){var a=r.transaction([o],"readwrite"),c=a.objectStore(o).put(n);c.onsuccess=function(){e()},c.onerror=function(e){t("Error saving to vault: "+e.target.error)},a.oncomplete=function(){r.close()}}))}},t)}))).apply(this,arguments)}function l(e){return f.apply(this,arguments)}function f(){return(f=r(e().m(function t(n){var r;return e().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,c();case 1:return r=e.v,e.a(2,new Promise(function(e,t){var a=r.transaction([o],"readonly"),c=a.objectStore(o).get(n);c.onsuccess=function(t){e(t.target.result)},c.onerror=function(e){t("Error retrieving from vault: "+e.target.error)},a.oncomplete=function(){r.close()}}))}},t)}))).apply(this,arguments)}function p(){return d.apply(this,arguments)}function d(){return(d=r(e().m(function t(){var n;return e().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,c();case 1:return n=e.v,e.a(2,new Promise(function(e,t){var r=n.transaction([o],"readonly"),a=r.objectStore(o).getAll();a.onsuccess=function(t){e(t.target.result)},a.onerror=function(e){t("Error retrieving all from vault: "+e.target.error)},r.oncomplete=function(){n.close()}}))}},t)}))).apply(this,arguments)}function v(e){return y.apply(this,arguments)}function y(){return(y=r(e().m(function t(n){var r;return e().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,c();case 1:return r=e.v,e.a(2,new Promise(function(e,t){var o=r.transaction([a],"readwrite"),c=o.objectStore(a).put(n);c.onsuccess=function(){e()},c.onerror=function(e){t("Error saving settings: "+e.target.error)},o.oncomplete=function(){r.close()}}))}},t)}))).apply(this,arguments)}function m(e){return h.apply(this,arguments)}function h(){return(h=r(e().m(function t(n){var r;return e().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,c();case 1:return r=e.v,e.a(2,new Promise(function(e,t){var o=r.transaction([a],"readonly"),c=o.objectStore(a).get(n);c.onsuccess=function(t){e(t.target.result)},c.onerror=function(e){t("Error retrieving settings: "+e.target.error)},o.oncomplete=function(){r.close()}}))}},t)}))).apply(this,arguments)}function g(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof i?r:i,s=Object.create(u.prototype);return b(s,"_invoke",function(n,r,o){var a,i,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,i=0,u=e,p.n=n,c}};function d(n,r){for(i=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,a=l[t],d=p.p,v=a[2];n>3?(o=v===r)&&(u=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=n<2&&d<a[1])?(i=0,p.v=r,p.n=a[1]):d<v&&(o=n<3||a[0]>r||r>v)&&(a[4]=n,a[5]=r,p.n=v,i=0))}if(o||n>1)return c;throw f=!0,r}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,v),i=l,u=v;(t=i<2?e:u)||!f;){a||(i?i<3?(i>1&&(p.n=-1),d(i,u)):p.n=u:p.v=u);try{if(s=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==c)break}catch(t){a=e,i=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,a),!0),s}var c={};function i(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(b(t={},r,function(){return this}),t),f=s.prototype=i.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,b(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,b(f,"constructor",s),b(s,"constructor",u),u.displayName="GeneratorFunction",b(s,o,"GeneratorFunction"),b(f),b(f,o,"Generator"),b(f,r,function(){return this}),b(f,"toString",function(){return"[object Generator]"}),(g=function(){return{w:a,m:p}})()}function b(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}b=function(e,t,n,r){function a(t,n){b(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},b(e,t,n,r)}function w(e,t,n,r,o,a,c){try{var i=e[a](c),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,o)}function E(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function c(e){w(a,r,o,c,i,"next",e)}function i(e){w(a,r,o,c,i,"throw",e)}c(void 0)})}}function k(e,t){return S.apply(this,arguments)}function S(){return S=E(g().m(function e(t,n){var r,o,a,c=arguments;return g().w(function(e){for(;;)switch(e.n){case 0:return r=c.length>2&&void 0!==c[2]?c[2]:1e5,o=new TextEncoder,e.n=1,window.crypto.subtle.importKey("raw",o.encode(t),{name:"PBKDF2"},!1,["deriveKey"]);case 1:return a=e.v,e.a(2,window.crypto.subtle.deriveKey({name:"PBKDF2",salt:n,iterations:r,hash:"SHA-256"},a,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]))}},e)})),S.apply(this,arguments)}function O(e,t){return j.apply(this,arguments)}function j(){return(j=E(g().m(function e(t,n){var r,o,a;return g().w(function(e){for(;;)switch(e.n){case 0:return r=new TextEncoder,o=window.crypto.getRandomValues(new Uint8Array(12)),e.n=1,window.crypto.subtle.encrypt({name:"AES-GCM",iv:o},t,r.encode(n));case 1:return a=e.v,e.a(2,{iv:Array.from(o),ciphertext:Array.from(new Uint8Array(a))})}},e)}))).apply(this,arguments)}function I(e,t,n){return L.apply(this,arguments)}function L(){return(L=E(g().m(function e(t,n,r){var o,a,c,i;return g().w(function(e){for(;;)switch(e.n){case 0:return o=new TextDecoder,a=new Uint8Array(r),c=new Uint8Array(n),e.n=1,window.crypto.subtle.decrypt({name:"AES-GCM",iv:c},t,a);case 1:return i=e.v,e.a(2,o.decode(i))}},e)}))).apply(this,arguments)}function P(e){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P(e)}function T(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return x(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?x(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){i=!0,a=e},f:function(){try{c||null==n.return||n.return()}finally{if(i)throw a}}}}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function A(e,t,n){return(t=function(e){var t=function(e){if("object"!=P(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=P(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==P(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function G(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof i?r:i,s=Object.create(u.prototype);return B(s,"_invoke",function(n,r,o){var a,i,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,i=0,u=e,p.n=n,c}};function d(n,r){for(i=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,a=l[t],d=p.p,v=a[2];n>3?(o=v===r)&&(u=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=n<2&&d<a[1])?(i=0,p.v=r,p.n=a[1]):d<v&&(o=n<3||a[0]>r||r>v)&&(a[4]=n,a[5]=r,p.n=v,i=0))}if(o||n>1)return c;throw f=!0,r}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,v),i=l,u=v;(t=i<2?e:u)||!f;){a||(i?i<3?(i>1&&(p.n=-1),d(i,u)):p.n=u:p.v=u);try{if(s=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==c)break}catch(t){a=e,i=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,a),!0),s}var c={};function i(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(B(t={},r,function(){return this}),t),f=s.prototype=i.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,B(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,B(f,"constructor",s),B(s,"constructor",u),u.displayName="GeneratorFunction",B(s,o,"GeneratorFunction"),B(f),B(f,o,"Generator"),B(f,r,function(){return this}),B(f,"toString",function(){return"[object Generator]"}),(G=function(){return{w:a,m:p}})()}function B(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}B=function(e,t,n,r){function a(t,n){B(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},B(e,t,n,r)}function _(e,t,n,r,o,a,c){try{var i=e[a](c),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,o)}function N(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function c(e){_(a,r,o,c,i,"next",e)}function i(e){_(a,r,o,c,i,"throw",e)}c(void 0)})}}var C,U="vault-metadata",F="vault-salt",D=null,M=!0,J="session-master-key";function R(e){return z.apply(this,arguments)}function z(){return z=N(G().m(function e(t){var n,r,o,a,c,i,s,f,p,d,v,y,h,g,b=arguments;return G().w(function(e){for(;;)switch(e.p=e.n){case 0:return n=b.length>1&&void 0!==b[1]?b[1]:5,e.p=1,e.n=2,m(F);case 2:if(r=e.v){e.n=3;break}return e.a(2,!1);case 3:return o=new Uint8Array(r.salt),e.n=4,k(t,o);case 4:return D=e.v,e.n=5,l(U);case 5:if(a=e.v){e.n=6;break}return e.a(2,!1);case 6:return e.p=6,e.n=7,I(D,a.data.iv,a.data.ciphertext);case 7:return c=e.v,JSON.parse(c),(i=JSON.parse(c)).lastAccessed=(new Date).toISOString(),e.n=8,O(D,JSON.stringify(i));case 8:return s=e.v,e.n=9,u({id:U,data:s});case 9:return M=!1,e.p=10,e.n=11,window.crypto.subtle.exportKey("raw",D);case 11:return f=e.v,p=Array.from(new Uint8Array(f)),e.n=12,chrome.storage.session.set(A({},J,p));case 12:e.n=14;break;case 13:e.p=13,y=e.v,console.warn("Could not persist session key:",y);case 14:return d=n,e.p=15,e.n=16,m("user-settings");case 16:(v=e.v)&&(!1===v.autoLockEnabled?d=0:v.autoLockTime>0&&(d=v.autoLockTime)),console.log("Using auto-lock timeout: ".concat(d," minutes")),e.n=18;break;case 17:e.p=17,h=e.v,console.error("Error getting user settings:",h);case 18:return e.a(2,!0);case 19:return e.p=19,e.v,e.a(2,!1);case 20:return e.p=20,g=e.v,console.error("Error unlocking vault:",g),e.a(2,!1);case 21:return e.a(2)}},e,null,[[15,17],[10,13],[6,19],[1,20]])})),z.apply(this,arguments)}function K(){return M}function V(){return H.apply(this,arguments)}function H(){return(H=N(G().m(function e(){var t,n,r,o,a,c,i,u,s;return G().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!M&&D){e.n=1;break}throw new Error("Vault is locked");case 1:return e.p=1,e.n=2,p();case 2:t=e.v,n=[],r=T(t),e.p=3,r.s();case 4:if((o=r.n()).done){e.n=9;break}if((a=o.value).id!==U){e.n=5;break}return e.a(3,8);case 5:return e.p=5,e.n=6,I(D,a.data.iv,a.data.ciphertext);case 6:c=e.v,n.push(JSON.parse(c)),e.n=8;break;case 7:e.p=7,i=e.v,console.error("Error decrypting credential ".concat(a.id,":"),i);case 8:e.n=4;break;case 9:e.n=11;break;case 10:e.p=10,u=e.v,r.e(u);case 11:return e.p=11,r.f(),e.f(11);case 12:return e.a(2,n);case 13:throw e.p=13,s=e.v,console.error("Error getting all credentials:",s),s;case 14:return e.a(2)}},e,null,[[5,7],[3,10,11,12],[1,13]])}))).apply(this,arguments)}function W(e,t){return $.apply(this,arguments)}function $(){return $=N(G().m(function e(t,n){var r,o,a,c,i,s,l,f,p,d,y;return G().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,R(t);case 1:if(e.v){e.n=2;break}return e.a(2,!1);case 2:return e.n=3,V();case 3:return r=e.v,o=window.crypto.getRandomValues(new Uint8Array(16)),e.n=4,k(n,o);case 4:a=e.v,c=T(r),e.p=5,c.s();case 6:if((i=c.n()).done){e.n=9;break}return s=i.value,e.n=7,O(a,JSON.stringify(s));case 7:return l=e.v,e.n=8,u({id:s.id,url:s.url,username:s.username,data:l});case 8:e.n=6;break;case 9:e.n=11;break;case 10:e.p=10,d=e.v,c.e(d);case 11:return e.p=11,c.f(),e.f(11);case 12:return f={id:U,created:(new Date).toISOString(),lastModified:(new Date).toISOString(),version:1},e.n=13,O(a,JSON.stringify(f));case 13:return p=e.v,e.n=14,u({id:U,data:p});case 14:return e.n=15,v({id:F,salt:Array.from(o)});case 15:return D=a,e.a(2,!0);case 16:return e.p=16,y=e.v,console.error("Error changing master password:",y),e.a(2,!1)}},e,null,[[5,10,11,12],[0,16]])})),$.apply(this,arguments)}function q(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof i?r:i,s=Object.create(u.prototype);return Q(s,"_invoke",function(n,r,o){var a,i,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,i=0,u=e,p.n=n,c}};function d(n,r){for(i=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,a=l[t],d=p.p,v=a[2];n>3?(o=v===r)&&(u=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=n<2&&d<a[1])?(i=0,p.v=r,p.n=a[1]):d<v&&(o=n<3||a[0]>r||r>v)&&(a[4]=n,a[5]=r,p.n=v,i=0))}if(o||n>1)return c;throw f=!0,r}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,v),i=l,u=v;(t=i<2?e:u)||!f;){a||(i?i<3?(i>1&&(p.n=-1),d(i,u)):p.n=u:p.v=u);try{if(s=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==c)break}catch(t){a=e,i=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,a),!0),s}var c={};function i(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(Q(t={},r,function(){return this}),t),f=s.prototype=i.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Q(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,Q(f,"constructor",s),Q(s,"constructor",u),u.displayName="GeneratorFunction",Q(s,o,"GeneratorFunction"),Q(f),Q(f,o,"Generator"),Q(f,r,function(){return this}),Q(f,"toString",function(){return"[object Generator]"}),(q=function(){return{w:a,m:p}})()}function Q(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Q=function(e,t,n,r){function a(t,n){Q(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},Q(e,t,n,r)}function X(e,t,n,r,o,a,c){try{var i=e[a](c),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,o)}function Y(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function c(e){X(a,r,o,c,i,"next",e)}function i(e){X(a,r,o,c,i,"throw",e)}c(void 0)})}}(C=N(G().m(function e(){var t,n,r;return G().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,chrome.storage.session.get(J);case 1:if(t=e.v,!((n=t&&t[J])&&Array.isArray(n)&&n.length>0)){e.n=3;break}return r=new Uint8Array(n).buffer,e.n=2,window.crypto.subtle.importKey("raw",r,{name:"AES-GCM"},!1,["encrypt","decrypt"]);case 2:D=e.v,M=!1;case 3:e.n=5;break;case 4:e.p=4,e.v;case 5:return e.a(2)}},e,null,[[0,4]])})),function(){return C.apply(this,arguments)})();var Z=document.getElementById("auto-lock-enabled"),ee=document.getElementById("auto-lock-time"),te=document.getElementById("key-stretching"),ne=document.getElementById("theme"),re=document.getElementById("font-size"),oe=document.getElementById("font-size-value"),ae=document.getElementById("autofill-enabled"),ce=document.getElementById("autofill-icon-enabled"),ie=document.getElementById("autofill-confirmation"),ue=document.getElementById("default-password-length"),se=document.getElementById("default-length-value"),le=document.getElementById("include-uppercase"),fe=document.getElementById("include-lowercase"),pe=document.getElementById("include-numbers"),de=document.getElementById("include-symbols"),ve=document.getElementById("current-password"),ye=document.getElementById("new-password"),me=document.getElementById("confirm-password"),he=document.getElementById("change-password-button"),ge=document.getElementById("export-button"),be=document.getElementById("import-button"),we=document.getElementById("import-file"),Ee=document.getElementById("clear-data-button"),ke=document.getElementById("status-message"),Se="user-settings",Oe="generator-settings";function je(){return Ie.apply(this,arguments)}function Ie(){return(Ie=Y(q().m(function e(){var t,n,r,o,a;return q().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,m(Se);case 1:if(r=e.v){e.n=2;break}r=Le();case 2:return t=r,e.n=3,m(Oe);case 3:if(o=e.v){e.n=4;break}o=Pe();case 4:n=o,Z.checked=t.autoLockEnabled,ee.value=t.autoLockTime,te.value=t.keyStretchingIterations,ne.value=t.theme,re.value=t.fontSize,oe.textContent="".concat(t.fontSize,"px"),ae.checked=t.autofillEnabled,ce.checked=t.autofillIconEnabled,ie.checked=t.autofillConfirmation,ue.value=n.defaultLength,se.textContent="".concat(n.defaultLength," characters"),le.checked=n.includeUppercase,fe.checked=n.includeLowercase,pe.checked=n.includeNumbers,de.checked=n.includeSymbols,Ce(t.theme),e.n=6;break;case 5:throw e.p=5,a=e.v,console.error("Error loading settings:",a),a;case 6:return e.a(2)}},e,null,[[0,5]])}))).apply(this,arguments)}function Le(){return{id:Se,autoLockEnabled:!0,autoLockTime:5,keyStretchingIterations:1e5,theme:"light",fontSize:14,autofillEnabled:!0,autofillIconEnabled:!0,autofillConfirmation:!0}}function Pe(){return{id:Oe,defaultLength:16,includeUppercase:!0,includeLowercase:!0,includeNumbers:!0,includeSymbols:!0}}function Te(){Z.addEventListener("change",xe),ee.addEventListener("change",xe),te.addEventListener("change",xe),ne.addEventListener("change",_e),re.addEventListener("input",Ue),ae.addEventListener("change",xe),ce.addEventListener("change",xe),ie.addEventListener("change",xe),ue.addEventListener("input",Fe),le.addEventListener("change",Ge),fe.addEventListener("change",Ge),pe.addEventListener("change",Ge),de.addEventListener("change",Ge),he.addEventListener("click",De),ge.addEventListener("click",Je),be.addEventListener("click",function(){return we.click()}),we.addEventListener("change",ze),Ee.addEventListener("click",Ve)}function xe(){return Ae.apply(this,arguments)}function Ae(){return(Ae=Y(q().m(function e(){var t,n;return q().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,t={id:Se,autoLockEnabled:Z.checked,autoLockTime:parseInt(ee.value),keyStretchingIterations:parseInt(te.value),theme:ne.value,fontSize:parseInt(re.value),autofillEnabled:ae.checked,autofillIconEnabled:ce.checked,autofillConfirmation:ie.checked},e.n=1,v(t);case 1:We("Settings saved successfully","success"),e.n=3;break;case 2:e.p=2,n=e.v,console.error("Error saving settings:",n),We("Error saving settings","error");case 3:return e.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}function Ge(){return Be.apply(this,arguments)}function Be(){return(Be=Y(q().m(function e(){var t,n;return q().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,t={id:Oe,defaultLength:parseInt(ue.value),includeUppercase:le.checked,includeLowercase:fe.checked,includeNumbers:pe.checked,includeSymbols:de.checked},e.n=1,v(t);case 1:We("Password generator settings saved","success"),e.n=3;break;case 2:e.p=2,n=e.v,console.error("Error saving generator settings:",n),We("Error saving generator settings","error");case 3:return e.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}function _e(){return Ne.apply(this,arguments)}function Ne(){return(Ne=Y(q().m(function e(){return q().w(function(e){for(;;)switch(e.n){case 0:return Ce(ne.value),e.n=1,xe();case 1:return e.a(2)}},e)}))).apply(this,arguments)}function Ce(e){"dark"===e||"system"===e&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.body.classList.add("dark-theme"):document.body.classList.remove("dark-theme")}function Ue(){oe.textContent="".concat(re.value,"px"),document.documentElement.style.setProperty("--font-size","".concat(re.value,"px")),xe()}function Fe(){se.textContent="".concat(ue.value," characters"),Ge()}function De(){return Me.apply(this,arguments)}function Me(){return(Me=Y(q().m(function e(){var t,n,r,o;return q().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,t=ve.value,n=ye.value,r=me.value,t){e.n=1;break}return We("Please enter your current password","error"),e.a(2);case 1:if(!(n.length<8)){e.n=2;break}return We("New password must be at least 8 characters","error"),e.a(2);case 2:if(n===r){e.n=3;break}return We("New password and confirmation do not match","error"),e.a(2);case 3:return e.n=4,W(t,n);case 4:e.v?(ve.value="",ye.value="",me.value="",We("Master password changed successfully","success")):We("Failed to change password. Current password may be incorrect.","error"),e.n=6;break;case 5:e.p=5,o=e.v,console.error("Change password error:",o),We("Error changing password","error");case 6:return e.a(2)}},e,null,[[0,5]])}))).apply(this,arguments)}function Je(){return Re.apply(this,arguments)}function Re(){return(Re=Y(q().m(function e(){var t,n,r,o,a;return q().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,!K()){e.n=1;break}return We("Please unlock your vault first","warning"),e.a(2);case 1:t={version:"1.0.0",timestamp:(new Date).toISOString(),credentials:[]},n=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),r=URL.createObjectURL(n),(o=document.createElement("a")).href=r,o.download="secure-shelf-export-".concat((new Date).toISOString().split("T")[0],".json"),o.click(),URL.revokeObjectURL(r),We("Data exported successfully","success"),e.n=3;break;case 2:e.p=2,a=e.v,console.error("Export error:",a),We("Error exporting data","error");case 3:return e.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}function ze(e){return Ke.apply(this,arguments)}function Ke(){return Ke=Y(q().m(function e(t){var n,r,o;return q().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,n=t.target.files[0]){e.n=1;break}return e.a(2);case 1:if(!K()){e.n=2;break}return We("Please unlock your vault first","warning"),e.a(2);case 2:(r=new FileReader).onload=function(){var e=Y(q().m(function e(t){var n,r;return q().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,(n=JSON.parse(t.target.result)).version&&n.credentials){e.n=1;break}throw new Error("Invalid import data format");case 1:We("Data imported successfully","success"),e.n=3;break;case 2:e.p=2,r=e.v,console.error("Import parsing error:",r),We("Invalid import file","error");case 3:return e.a(2)}},e,null,[[0,2]])}));return function(t){return e.apply(this,arguments)}}(),r.readAsText(n),e.n=4;break;case 3:e.p=3,o=e.v,console.error("Import error:",o),We("Error importing data","error");case 4:return e.p=4,t.target.value="",e.f(4);case 5:return e.a(2)}},e,null,[[0,3,4,5]])})),Ke.apply(this,arguments)}function Ve(){return He.apply(this,arguments)}function He(){return(He=Y(q().m(function e(){return q().w(function(e){for(;;)switch(e.n){case 0:if(confirm("WARNING: This will permanently delete all your stored passwords and settings. This action cannot be undone. Are you sure?"))try{We("All data cleared successfully","success"),setTimeout(function(){window.location.reload()},1500)}catch(e){console.error("Clear data error:",e),We("Error clearing data","error")}case 1:return e.a(2)}},e)}))).apply(this,arguments)}function We(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";ke.textContent=e,ke.className="status-message ".concat(t),ke.classList.remove("hidden"),"success"===t&&setTimeout(function(){ke.classList.add("hidden")},3e3)}document.addEventListener("DOMContentLoaded",Y(q().m(function e(){var t;return q().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,je();case 1:Te(),e.n=3;break;case 2:e.p=2,t=e.v,console.error("Error loading settings:",t),We("Error loading settings. Please try again.","error");case 3:return e.a(2)}},e,null,[[0,2]])})))})();