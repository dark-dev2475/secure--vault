let lockTimeoutId=null;const DEFAULT_LOCK_MINUTES=5;function setupContextMenus(){chrome.contextMenus.create({id:"fillCredential",title:"Fill with Secure Shelf",contexts:["editable"]}),chrome.contextMenus.create({id:"generatePassword",title:"Generate Password",contexts:["editable"]})}function resetLockTimer(e){lockTimeoutId&&clearTimeout(lockTimeoutId),lockTimeoutId=setTimeout(()=>{chrome.runtime.sendMessage({action:"autoLockVault"}),chrome.action.setIcon({path:{128:"icons/icon128-locked.svg"}}),lockTimeoutId=null},60*e*1e3),chrome.action.setIcon({path:{128:"icons/icon128.svg"}})}function clearLockTimer(){lockTimeoutId&&(clearTimeout(lockTimeoutId),lockTimeoutId=null),chrome.action.setIcon({path:{128:"icons/icon128-locked.svg"}})}chrome.contextMenus.onClicked.addListener((e,t)=>{"fillCredential"===e.menuItemId?chrome.tabs.sendMessage(t.id,{action:"requestFillCredential"}):"generatePassword"===e.menuItemId&&chrome.tabs.sendMessage(t.id,{action:"requestGeneratePassword"})}),chrome.runtime.onMessage.addListener((e,t,c)=>{switch(e.action){case"unlockVault":resetLockTimer(e.lockAfterMinutes||5),c({success:!0});break;case"lockVault":clearLockTimer(),c({success:!0});break;case"getActiveTab":return chrome.tabs.query({active:!0,currentWindow:!0},e=>{e&&e[0]?c({url:e[0].url,tabId:e[0].id}):c({url:null,tabId:null})}),!0;default:c({success:!0,message:"Message received"})}return!0}),chrome.runtime.onInstalled.addListener(()=>{setupContextMenus()});